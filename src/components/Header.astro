---
import { Icon } from 'astro-icon/components';
---

<header class="cs_site_header header_style_2 cs_style_1 cs_sticky_header cs_site_header_full_width header-transparent" id="main-header">
  <div class="cs_main_header">
    <div class="container">
      <div class="cs_main_header_in">
        <div class="cs_main_header_left">
          <a class="cs_site_branding" href="/">
            <img src="/images/logo.png" alt="Logo">
          </a>
        </div>
        <div class="cs_main_header_center">
          <div class="cs_nav cs_primary_font fw-medium">
            <span class="cs-munu_toggle">
              <span></span>
            </span>
            <div class="menu-overlay"></div>
            <ul class="cs_nav_list fw-medium">
              <li>
                <a href="/">HOME</a>
              </li>
              <li>
                <a href="/about">ABOUT</a>
              </li>
              <li>
                <a href="/services">SERVICES</a>
              </li>
              <li>
                <a href="/news">NEWS</a>
              </li>
              <li>
                <a href="/program">PROGRAMS</a>
              </li>
              <li>
                <a href="/career">CAREER</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="cs_main_header_right">
          <div class="header-btn d-flex align-items-center">
            <a class="search-trigger search-icon">
              <i class="bi bi-search"></i>
            </a>
            <div class="header-button ms-4">
              <button type="button" class="theme-btn" onclick="window.dispatchEvent(new Event('openContactModal'))">
                <span>Get Started<i class="bi bi-arrow-right"></i></span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<style>
  /* Header background transitions */
  .header-transparent {
    background: transparent !important;
    transition: all 0.3s ease, backdrop-filter 0.3s ease;
  }

  .header-scrolled {
    background: transparent !important;
    backdrop-filter: none;
    box-shadow: none;
  }

  /* Ensure header content is properly styled */
  #main-header.cs_site_header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 999;
    width: 100%;
    transition: all 0.3s ease;
  }

  /* Compact menu bar when scrolled */
  #main-header.header-compact {
    padding: 12px 0;
  }

  #main-header.header-compact .cs_main_header {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #main-header.header-compact .cs_main_header_in {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
  }

  /* Hide logo and right section when scrolled (only on desktop) */
  @media (min-width: 992px) {
    #main-header.header-compact .cs_main_header_left,
    #main-header.header-compact .cs_main_header_right {
      display: none !important;
    }

    /* Compact navigation bar */
    #main-header.header-compact .cs_main_header_center {
      width: 100% !important;
      display: flex !important;
      justify-content: center !important;
      flex: 1 !important;
    }

    #main-header.header-compact .cs_nav {
      width: auto !important;
      display: flex !important;
      justify-content: center !important;
      margin: 0 auto !important;
    }

    /* Compact menu list with rounded background */
    #main-header.header-compact .cs_nav_list {
      display: flex !important;
      align-items: center !important;
      gap: 2px !important;
      background: #4a4a4a !important;
      border-radius: 50px !important;
      padding: 6px 18px !important;
      margin: 0 auto !important;
      list-style: none !important;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2) !important;
      flex-direction: row !important;
      flex-wrap: nowrap !important;
      height: auto !important;
    }
  }

  /* Compact menu list styles - only on desktop */
  @media (min-width: 992px) {
    #main-header.header-compact .cs_nav_list li {
      margin: 0 !important;
      padding: 0 !important;
      list-style: none !important;
    }

    #main-header.header-compact .cs_nav_list li a {
      color: #ffffff !important;
      font-weight: 600 !important;
      font-size: 14px !important;
      padding: 8px 18px !important;
      display: block !important;
      text-decoration: none !important;
      transition: all 0.3s ease !important;
      border-radius: 25px !important;
      white-space: nowrap !important;
      background: transparent !important;
      line-height: 1.5 !important;
      letter-spacing: 0.3px !important;
    }

    #main-header.header-compact .cs_nav_list li a:hover {
      background: rgba(255, 255, 255, 0.15) !important;
      color: #ffffff !important;
    }

    #main-header.header-compact .cs_nav_list li a:before,
    #main-header.header-compact .cs_nav_list li a:after {
      display: none !important;
    }
  }

  /* Mobile menu active state - applies to all mobile screens */
  @media (max-width: 991px) {
    /* Show menu list when active (clicked) - full screen mobile menu */
    /* Override all header-compact styles when menu is active */
    #main-header .cs_nav_list.active,
    #main-header.header-compact .cs_nav_list.active {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100vh !important;
      height: 100dvh !important;
      background: #FFFBF3 !important;
      z-index: 10000 !important;
      display: flex !important;
      flex-direction: column !important;
      padding: 70px 0 0 0 !important;
      margin: 0 !important;
      overflow-y: auto !important;
      transform: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      gap: 0 !important;
      align-items: stretch !important;
      justify-content: flex-start !important;
    }
    
    /* Menu items in active mobile menu - override header-compact styles */
    #main-header .cs_nav_list.active li,
    #main-header.header-compact .cs_nav_list.active li,
    #main-header .cs-munu_toggle.cs_teggle_active + .cs_nav_list li,
    #main-header.header-compact .cs-munu_toggle.cs_teggle_active + .cs_nav_list li {
      display: block !important;
      width: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      list-style: none !important;
    }
    
    /* Menu links in active mobile menu - override header-compact styles */
    #main-header .cs_nav_list.active li a,
    #main-header.header-compact .cs_nav_list.active li a,
    #main-header .cs-munu_toggle.cs_teggle_active + .cs_nav_list li a,
    #main-header.header-compact .cs-munu_toggle.cs_teggle_active + .cs_nav_list li a {
      display: block !important;
      width: 100% !important;
      padding: 20px 25px !important;
      color: #000000 !important;
      font-weight: 600 !important;
      text-decoration: none !important;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
      border-radius: 0 !important;
      background: transparent !important;
      white-space: normal !important;
      text-align: left !important;
    }
    
    /* Hide menu list when not active on mobile */
    #main-header .cs_nav_list:not(.active),
    #main-header.header-compact .cs_nav_list:not(.active) {
      display: none !important;
    }
    
    /* Force menu active to show - highest priority */
    #main-header.header-compact .cs_nav_list.active,
    #main-header .cs_nav_list.active,
    #main-header .cs-munu_toggle.cs_teggle_active + .cs_nav_list,
    #main-header.header-compact .cs-munu_toggle.cs_teggle_active + .cs_nav_list {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100vh !important;
      height: 100dvh !important;
      background: #FFFBF3 !important;
      z-index: 10000 !important;
      flex-direction: column !important;
      padding: 70px 0 0 0 !important;
      margin: 0 !important;
      overflow-y: auto !important;
      transform: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      gap: 0 !important;
      align-items: stretch !important;
      justify-content: flex-start !important;
    }
    
    /* Overlay for mobile menu */
    #main-header .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    #main-header .menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    /* Prevent body scroll when menu is open */
    body.menu-open {
      overflow: hidden !important;
    }
  }

  /* Mobile: Keep normal layout when scrolled */
  @media (max-width: 991px) {
    #main-header.header-compact .cs_main_header_left,
    #main-header.header-compact .cs_main_header_right {
      display: flex !important;
    }
    
    #main-header.header-compact .cs_main_header_center {
      width: auto !important;
      flex: 0 !important;
    }
    
    #main-header.header-compact .cs_nav {
      width: auto !important;
      justify-content: flex-start !important;
    }
    
    
    /* Ensure menu toggle is visible and clickable */
    #main-header.header-compact .cs-munu_toggle {
      display: block !important;
      cursor: pointer !important;
      z-index: 1000 !important;
      position: relative !important;
    }
    
    /* Ensure menu toggle is always visible on mobile */
    #main-header .cs-munu_toggle {
      display: block !important;
      cursor: pointer !important;
      z-index: 1000 !important;
      position: relative !important;
    }
  }

  /* Hide mobile menu toggle when compact (only on desktop) */
  @media (min-width: 992px) {
    #main-header.header-compact .cs-munu_toggle {
      display: none;
    }
  }

  /* Responsive adjustments for mobile */
  @media (max-width: 991px) {
    #main-header.header-compact {
      padding: 10px 0;
    }
  }

  @media (max-width: 767px) {
    #main-header.header-compact {
      padding: 8px 0;
    }
  }
</style>

<script>
  // Mobile menu toggle functionality
  document.addEventListener('DOMContentLoaded', function() {
    // Toggle mobile menu
    const menuToggle = document.querySelector('.cs-munu_toggle');
    const navList = document.querySelector('.cs_nav_list');
    const overlay = document.querySelector('.menu-overlay');
    const body = document.body;
    
    function openMenu() {
      if (navList) navList.classList.add('active');
      if (menuToggle) menuToggle.classList.add('cs_teggle_active');
      if (overlay) overlay.classList.add('active');
      body.classList.add('menu-open');
    }
    
    function closeMenu() {
      if (navList) navList.classList.remove('active');
      if (menuToggle) menuToggle.classList.remove('cs_teggle_active');
      if (overlay) overlay.classList.remove('active');
      body.classList.remove('menu-open');
    }
    
    function toggleMenu() {
      if (navList && navList.classList.contains('active')) {
        closeMenu();
      } else {
        openMenu();
      }
    }
    
    if (menuToggle && navList) {
      menuToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleMenu();
      });
    }
    
    // Close menu when clicking overlay
    if (overlay) {
      overlay.addEventListener('click', function() {
        closeMenu();
      });
    }
    
    // Close menu when clicking outside (on mobile)
    if (window.innerWidth <= 991) {
      document.addEventListener('click', function(e) {
        if (navList && navList.classList.contains('active')) {
          const isClickInsideMenu = navList.contains(e.target);
          const isClickOnToggle = menuToggle && menuToggle.contains(e.target);
          if (!isClickInsideMenu && !isClickOnToggle) {
            closeMenu();
          }
        }
      });
    }

    // Header scroll behavior
    const header = document.getElementById('main-header');
    let lastScrollTop = 0;
    
    if (header) {
      function handleScroll() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        
        if (scrollTop > 100) {
          // When scrolled, show compact menu
          header.classList.remove('header-transparent');
          header.classList.add('header-scrolled', 'header-compact');
        } else {
          // When at top, show full header
          header.classList.add('header-transparent');
          header.classList.remove('header-scrolled', 'header-compact');
        }
        
        lastScrollTop = scrollTop;
      }

      // Initial check for scroll position
      handleScroll();
      
      // Add scroll event listener
      window.addEventListener('scroll', handleScroll, { passive: true });
    }
  });
</script>
